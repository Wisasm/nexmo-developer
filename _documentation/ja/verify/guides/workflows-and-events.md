---
title:  ワークフローとイベント
description:  検証プロセスの段階とタイミング
navigation_weight: 1

---


ワークフローとイベント
===========

Verify API は、SMS と TTS (テキスト読み上げ) の呼び出しを順番に組み合わせることで、ユーザーにリーチできる可能性を最大限に高めます。基本的なモデルは、[Verify リクエストを作成](/verify/code-snippets/send-verify-request)すると、`request_id` が割り当てられ、Nexmo が一連のアクションを開始して PIN コードでユーザーにリーチするというものです。ユーザーがコードを送信したら、コードを `request_id` から Nexmo に送信し、[コードが正しいことを確認します](/verify/code-snippets/check-verify-request)。

コードと `request_id` を送信すると、Nexmo はコードが期待どおりであるかどうかを確認します。検証が成功すると、シーケンスは停止し、それ以上の呼び出しやメッセージはユーザーに送信されません。検証が失敗した場合、シーケンスは続行され、PIN の有効期限が切れるか、3 つの誤ったコードが送信されるまでアクティブのままになります。

Verify API を使用すると、ユースケースに最適なワークフローを選択できます。これは、行われる検証のタイプ、ユーザーの好み、または地理的な場所によって異なる場合があります。`workflow_id` フィールドを整数値 1 ～ 7 に設定することで、各 Verify API リクエストに使用するワークフローを指定できます。これらのプリセットワークフローの詳細を以下に示します。

Verify リクエストの作成時に[タイミングを設定](/verify/guides/changing-default-timings)することで、体験をさらにカスタマイズできます。また、必要に応じて[次の検証試行をプログラムでトリガー](/verify/code-snippets/trigger-next-verification-process)することもできます。

ワークフロー 1 (デフォルトのワークフロー)：SMS -> TTS -> TTS
-------------------------------------------------

テキストメッセージで PIN コードを送信し、リクエストがまだ確認されていない場合は、2 回の後続の音声通話でフォローアップします。

1. PIN コードを **SMS** でユーザーに送信します
2. `next_event_wait` 秒待機 *(デフォルトの待機時間：125 秒)* 
3. ユーザーに電話し、 **TTS** PIN コードを伝えます
4. `next_event_wait` 秒待機 *(デフォルトの待機時間：180 秒)* 
5. (デフォルトのタイミングでは、PIN の有効期限が切れて新しい PIN が生成されます。`pin_expiry` フィールドを設定してこれを制御します)
6. ユーザーに電話し、 **TTS** PIN コードを伝えます
7. `next_event_wait` 秒待機 *(デフォルトの待機時間：300 秒)* 
8. リクエストの有効期限

ワークフロー 2：SMS -> SMS -> TTS
------------------------------

テキストメッセージで PIN コードを送信し、リクエストが確認されていない場合は、2 回目はテキストメッセージを送信し、最後に音声通話でフォローアップします。

1. PIN コードを **SMS** でユーザーに送信します
2. `next_event_wait` 秒待機 *(デフォルトの待機時間：125 秒)* 
3. PIN コードを **SMS** でユーザーに送信します
4. `next_event_wait` 秒待機 *(デフォルトの待機時間：180 秒)* 
5. (デフォルトのタイミングでは、PIN の有効期限が切れて新しい PIN が生成されます。`pin_expiry` フィールドを設定してこれを制御します)
6. ユーザーに電話し、 **TTS** PIN コードを伝えます
7. `next_event_wait` 秒待機 *(デフォルトの待機時間：300 秒)* 
8. リクエストの有効期限

ワークフロー 3：TTS -> TTS
---------------------

ユーザーに電話して PIN コードを伝え、リクエストがまだ確認されていない場合は 2 回目の電話でフォローアップします。

1. ユーザーに電話し、 **TTS** PIN コードを伝えます
2. `next_event_wait` 秒待機 *(デフォルトの待機時間：150 秒)* 
3. ユーザーに電話し、 **TTS** PIN コードを伝えます
4. `next_event_wait` 秒待機 *(デフォルトの待機時間：150 秒)* 
5. リクエストの有効期限

ワークフロー 4：SMS -> SMS
---------------------

テキストメッセージで PIN コードを送信し、コードが確認されていない場合は 2 回目のテキストメッセージでフォローアップします。

1. PIN コードを **SMS** でユーザーに送信します
2. `next_event_wait` 秒待機 *(デフォルトの待機時間：120 秒)* 
3. PIN コードを **SMS** でユーザーに送信します
4. `next_event_wait` 秒待機 *(デフォルトの待機時間：180 秒)* 
5. リクエストの有効期限

ワークフロー 5：SMS -> TTS
---------------------

テキストメッセージで PIN コードを送信し、コードが確認されていない場合は音声通話でフォローアップします。

1. PIN コードを **SMS** でユーザーに送信します
2. `next_event_wait` 秒待機 *(デフォルトの待機時間：120 秒)* 
3. ユーザーに電話し、 **TTS** PIN コードを伝えます
4. `next_event_wait` 秒待機 *(デフォルトの待機時間：180 秒)* 
5. リクエストの有効期限

ワークフロー 6：SMS
------------

PIN コードを 1 回だけテキストメッセージで送信します。

1. PIN コードを **SMS** でユーザーに送信します
2. リクエストは `pin_expiry` 秒後に期限切れになります *(デフォルトの有効期限：300 秒)* 

ワークフロー 7：TTS
------------

ユーザーに電話して、PIN コードを 1 回だけ伝えます。

1. ユーザーに電話し、 **TTS** PIN コードを伝えます
2. リクエストは `pin_expiry` 秒後に期限切れになります *(デフォルトの有効期限：300 秒)*

