---
title:  工作流和事件
description: 验证过程的阶段和计时
navigation_weight:  1

---


工作流和事件
======

Verify API 通过按次序组合短信和 TTS（文本转语音）呼叫最大程度地联系用户。基本模型是，当您[创建验证请求](/verify/code-snippets/send-verify-request)后，它会被分配一个 `request_id`，Nexmo 将开始一系列操作，以使用 PIN 码联系用户。当用户向您发送代码时，您会将代码连同 `request_id` 一起发送到 Nexmo，以[检查代码是否正确](/verify/code-snippets/check-verify-request)。

当您发送代码和 `request_id` 时，Nexmo 将确认代码是否符合预期。为实现成功验证，次序将停止且不会再有任何呼叫或消息发送给用户。如果验证失败，则次序将继续运行并保持有效，直到 PIN 过期或已发送三个错误代码。

Verify API 可让您为用例选择最佳工作流。这可能取决于进行验证的类型、用户偏好或其地理位置。您可以通过将 `workflow_id` 字段设置为整数值 1-7，指定每个 Verify API 请求的工作流。每个预设工作流的详细信息如下所示。

您可通过在创建验证请求时[设置计时](/verify/guides/changing-default-timings)进一步自定义体验，并可根据需要通过编程方式[触发下一次验证尝试](/verify/code-snippets/trigger-next-verification-process)。

工作流 1（默认工作流）：SMS -> TTS-> TTS
---------------------------------

通过短信发送 PIN 码，如果请求尚未验证，则随后进行两次语音通话。

1. 使用 PIN 码向用户发送 **短信** 
2. 等待 `next_event_wait` 秒 *（默认等待时间：125 秒）* 
3. 致电用户并提供 **TTS** PIN 码
4. 等待 `next_event_wait` 秒 *（默认等待时间：180 秒）* 
5. （由于默认计时，PIN 将过期并生成一个新的 PIN，这可通过设置 `pin_expiry` 字段进行控制）
6. 致电用户并提供 **TTS** PIN 码
7. 等待 `next_event_wait` 秒 *（默认等待时间：300 秒）* 
8. 请求过期

工作流 2：SMS -> SMS -> TTS
---------------------------

通过短信发送 PIN 码，然后发送第二条短信，如果请求没有得到验证，则最后进行语音通话。

1. 使用 PIN 码向用户发送 **短信** 
2. 等待 `next_event_wait` 秒 *（默认等待时间：125 秒）* 
3. 使用 PIN 码向用户发送 **短信** 
4. 等待 `next_event_wait` 秒 *（默认等待时间：180 秒）* 
5. （由于默认计时，PIN 将过期并生成一个新的 PIN，这可通过设置 `pin_expiry` 字段进行控制）
6. 致电用户并提供 **TTS** PIN 码
7. 等待 `next_event_wait` 秒 *（默认等待时间：300 秒）* 
8. 请求过期

工作流 3：TTS -> TTS
------------------

致电用户并提供 PIN 码，如果请求尚未验证，则拨打第二次电话。

1. 致电用户并提供 **TTS** PIN 码
2. 等待 `next_event_wait` 秒 *（默认等待时间：150 秒）* 
3. 致电用户并提供 **TTS** PIN 码
4. 等待 `next_event_wait` 秒 *（默认等待时间：150 秒）* 
5. 请求过期

工作流 4：SMS -> SMS
------------------

通过短信发送 PIN 码，如果代码未得到验证，则发送第二条短信。

1. 使用 PIN 码向用户发送 **短信** 
2. 等待 `next_event_wait` 秒 *（默认等待时间：120 秒）* 
3. 使用 PIN 码向用户发送 **短信** 
4. 等待 `next_event_wait` 秒 *（默认等待时间：180 秒）* 
5. 请求过期

工作流 5：SMS -> TTS
------------------

通过短信发送 PIN 码，如果代码未得到验证，则发送语音呼叫。

1. 使用 PIN 码向用户发送 **短信** 
2. 等待 `next_event_wait` 秒 *（默认等待时间：120 秒）* 
3. 致电用户并提供 **TTS** PIN 码
4. 等待 `next_event_wait` 秒 *（默认等待时间：180 秒）* 
5. 请求过期

工作流 6：SMS
---------

仅通过短信发送一次 PIN 码。

1. 使用 PIN 码向用户发送 **短信** 
2. 请求在 `pin_expiry` 秒后过期 *（默认有效期：300 秒）* 

工作流 7：TTS
---------

仅致电用户并提供 PIN 码一次。

1. 致电用户并提供 **TTS** PIN 码
2. 请求在 `pin_expiry` 秒后过期 *（默认有效期：300 秒）*

